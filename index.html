<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Samordle</title>
  <style>
    body {
      margin: 0;
      font-family: "Times New Roman", serif;
      background-color: #121213;
      color: white;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    
    #game {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .row {
      display: flex;
      gap: 5px;
    }

    .tile {
      width: 60px;
      height: 60px;
      border: 2px solid #3a3a3c;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      text-transform: uppercase;
      font-weight: bold;
      background-color: #121213;
    }

    .tile.correct {
      background-color: green;
    }
    .tile.present {
      background-color: gold;
    }
    .tile.absent {
      background-color: #3a3a3c;
    }

    #keyboard {
      margin-top: 30px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }

    .keyboard-row {
      display: flex;
      gap: 5px;
    }

    .key {
      background-color: #818384;
      color: white;
      border: none;
      padding: 12px;
      min-width: 36px;
      height: 60px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      font-size: 12px;
    }

    .key.wide {
      min-width: 50px;
    }

    .key.correct {
      background-color: green;
    }
    .key.present {
      background-color: gold;
    }
    .key.absent {
      background-color: #3a3a3c;
    }

    #win-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .win-box {
      background: #121213;
      padding: 2rem;
      border-radius: 10px;
      text-align: center;
    }


    #lose-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .lose-box {
      background: #121213;
      padding: 2rem;
      border-radius: 10px;
      text-align: center;
    }

    
    .hidden {
      display: none !important;
    }

    
    #play-again {
      background-color: #323236; 
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    #play-again-lose {
      background-color: #323236; 
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
  </style>
</head>
<body>
  <div id="container">
  <div id="game">
    <div class="row">
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
    </div>
    <div class="row">
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
    </div>
    <div class="row">
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
    </div>
    <div class="row">
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
    </div>
    <div class="row">
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
    </div>
    <div class="row">
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
      <div class="tile"></div>
    </div>
  </div>

  <div id="keyboard">
    <div class="keyboard-row">
      <button class ="key">Q</button>
      <button class ="key">W</button>
      <button class ="key">E</button>
      <button class ="key">R</button>
      <button class ="key">T</button>
      <button class ="key">Y</button>
      <button class ="key">U</button>
      <button class ="key">I</button>
      <button class ="key">O</button>
      <button class ="key">P</button>
    </div>
    <div class="keyboard-row">
      <button class ="key">A</button>
      <button class ="key">S</button>
      <button class ="key">D</button>
      <button class ="key">F</button>
      <button class ="key">G</button>
      <button class ="key">H</button>
      <button class ="key">J</button>
      <button class ="key">K</button>
      <button class ="key">L</button>
    </div>
    <div class="keyboard-row">
      <button class ="key wide" aria-label="Enter">ENTER</button>
      <button class ="key">Z</button>
      <button class ="key">X</button>
      <button class ="key">C</button>
      <button class ="key">V</button>
      <button class ="key">B</button>
      <button class ="key">N</button>
      <button class ="key">M</button>
      <button class ="key wide" aria-label="Backspace">âŒ«</button>
    </div>
    </div>
  </div>
  
    <div id="win-screen" class="hidden">
    <div class="win-box">
      <h2>ðŸŽ‰ You Win! ðŸŽ‰</h2>
      <button id="play-again">Play Again</button>
     </div>
  </div>

    <div id="lose-screen" class="hidden">
    <div class="lose-box">
      <h2>ðŸ˜¢ You Lose... ðŸ˜¢</h2>
      <button id="play-again-lose">Play Again</button>
     </div>
  </div>
  
  <script>

    function letterInput(letter) {
      if (col < 5) {
        const tile = rows[row].children[col];
        tile.textContent = letter;
        col++;
        console.log("Key pressed:", letter);
        
      }
    }

    function handleBackspace() {
      if (col > 0) {
        col--;
        const tile = rows[row].children[col];
        tile.textContent = "";
      }
    }

    function handleEnter() {
      let guess = "";
          if (col === 5) {
            for (let i = 0; i<5; i++) {
              guess += rows[row].children[i].textContent.trim();
            }
            guess = guess.toUpperCase();
            console.log("guess:", guess);
            console.log("in words?:", words.includes(guess));
            console.log(words[0], words[0].length);
            console.log(words[1909]);
            if (words.length === 0) {
              alert("Game still loading, please wait...");
              return;
            }
            
            if (words.includes(guess)) {
              const letterCounts = {};
              for (let i = 0; i < 5; i++) {
                const letter = solution[i];
                letterCounts[letter] = (letterCounts[letter] || 0) + 1;
              }

              for (let i = 0; i < 5; i++) {
                const tile = rows[row].children[i];
                const letter = guess[i];
                const key = Array.from(keys).find(k => k.textContent === guess[i]);
                if (letter === solution[i]) {
                  tile.classList.add("correct");
                  if (key.classList.contains("present")) {
                    key.classList.remove("present");
                  }
                  if (key.classList.contains("absent")) {
                    key.classList.remove("absent");
                  }
                  key.classList.add("correct");
                  letterCounts[letter]--;
                }
              }

              for (let i = 0; i < 5; i++) {
                const tile = rows[row].children[i];
                const letter = guess[i];
                const key = Array.from(keys).find(k => k.textContent === guess[i]);
                if (tile.classList.contains("correct")) continue; // already green
  
                if (solution.includes(letter) && letterCounts[letter] > 0) {
                  tile.classList.add("present");
                  if (!key.classList.contains("correct")) {
                    key.classList.add("present");
                  letterCounts[letter]--;
                  }
                } else {
                  tile.classList.add("absent");
                  if (!key.classList.contains("present") && !key.classList.contains("correct")) {
                    key.classList.add("absent");
                  }
                }
              }
            let corrects = 0;
            for (let i = 0; i < 5; i++) {
              if (guess[i] === solution[i]) {
                corrects++;
              }
            }
            if (corrects === 5) {
              document.getElementById("win-screen").classList.remove("hidden");
              return;
            }
            else {
              row++;
              if (row > 5) {
                document.getElementById("lose-screen").classList.remove("hidden");
                return;
              }
              col = 0;
            }
          }
            
            else {
              alert("Thats not a word bruh");
            }
          }
    }
  


    
    let words = [];
    fetch("words.txt")
      .then(response => response.text())
      .then(text => {
        words = text.split("\n").map(word => word.trim().toUpperCase());
      });
    let solutions = [];
    let solution = "";
    fetch("solutions.txt")
      .then(response => response.text())
      .then(text => {
        solutions = text.split("\n").map(word => word.trim().toUpperCase());
        solution = solutions[Math.floor(Math.random() * solutions.length)];
        console.log("target word:", solution);
        const letterCounts = {};
        for (let i = 0; i < 5; i++) {
          const letter = solution[i];
          letterCounts[letter] = (letterCounts[letter] || 0) + 1;
        }
      });
    
    let row = 0;
    let col = 0;
    
    const rows = document.querySelectorAll(".row");
    const keys = document.querySelectorAll(".key");
    
    keys.forEach(key => {
      key.addEventListener("click", () => {
        if (key.textContent === "âŒ«") {
          handleBackspace();
          return;
        }
        
        if (key.textContent === "ENTER") {
          handleEnter();
          return;
          }
        letterInput(key.textContent);
          
        
        });
      });
    document.addEventListener("keydown", (event) => {
      const key = event.key.toUpperCase();

      if (key === "BACKSPACE") {
        event.preventDefault();
        handleBackspace();
      } else if (key === "ENTER") {
        event.preventDefault();
        handleEnter();
      } else if (/^[A-Z]$/.test(key)) {  // Only letters A-Z
        letterInput(key);
      }
    });
        document.getElementById("play-again").addEventListener("click", () => {
          location.reload();
      });    
        document.getElementById("play-again-lose").addEventListener("click", () => {
          location.reload();
      });            
    
  </script>
  
</body>
</html>
